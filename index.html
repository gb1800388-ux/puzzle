<!DOCTYPE html>
<html lang="ru">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Генератор Пазлов - Puzzle Generator</title>
    <link rel="stylesheet" href="styles.css">
</head>
<body>
    <div class="container">
        <header>
            <h1>Генератор Пазлов</h1>
            <p>Создайте пазлы для печати и вырезания на ЧПУ</p>
        </header>

        <div class="main-content">
            <!-- Left Panel - Controls -->
            <div class="controls-panel">
                <div class="control-section">
                    <h3>Загрузка изображения</h3>
                    <div class="upload-area" id="uploadArea">
                        <input type="file" id="imageUpload" accept="image/*" hidden>
                        <div class="upload-placeholder" id="uploadPlaceholder">
                            <div class="upload-icon">+</div>
                            <p>Нажмите или перетащите изображение</p>
                            <span class="upload-hint">JPG, PNG, GIF до 10MB</span>
                        </div>
                        <img id="imagePreview" class="image-preview" alt="Preview">
                    </div>
                </div>

                <div class="control-section">
                    <h3>Форма пазла</h3>
                    <div class="shape-selector">
                        <label class="shape-option">
                            <input type="radio" name="puzzleForm" value="rectangular" checked>
                            <div class="shape-card">
                                <div class="shape-icon rectangular-icon"></div>
                                <span>Прямоугольный</span>
                            </div>
                        </label>
                        <label class="shape-option">
                            <input type="radio" name="puzzleForm" value="square">
                            <div class="shape-card">
                                <div class="shape-icon square-icon"></div>
                                <span>Квадратный</span>
                            </div>
                        </label>
                        <label class="shape-option">
                            <input type="radio" name="puzzleForm" value="circular">
                            <div class="shape-card">
                                <div class="shape-icon circular-icon"></div>
                                <span>Круговой</span>
                            </div>
                        </label>
                    </div>
                </div>

                <div class="control-section">
                    <h3>Тип элементов</h3>
                    <div class="piece-type-selector">
                        <label class="piece-type-option">
                            <input type="radio" name="pieceType" value="classic" checked>
                            <div class="piece-type-card">
                                <svg class="piece-type-icon" viewBox="0 0 60 60">
                                    <path d="M5 10 L22 10 L22 10 L22 5 C22 0 28 0 28 5 L28 10 L38 10 L38 5 C38 0 44 0 44 5 L44 10 L55 10 L55 22 L60 22 C65 22 65 28 60 28 L55 28 L55 38 L60 38 C65 38 65 44 60 44 L55 44 L55 55 L44 55 L44 60 C44 65 38 65 38 60 L38 55 L28 55 L28 60 C28 65 22 65 22 60 L22 55 L5 55 L5 44 L0 44 C-5 44 -5 38 0 38 L5 38 L5 28 L0 28 C-5 28 -5 22 0 22 L5 22 Z"
                                          fill="none" stroke="currentColor" stroke-width="2"/>
                                </svg>
                                <span>Классический</span>
                                <small>С замками</small>
                            </div>
                        </label>
                        <label class="piece-type-option">
                            <input type="radio" name="pieceType" value="grid">
                            <div class="piece-type-card">
                                <svg class="piece-type-icon" viewBox="0 0 60 60">
                                    <rect x="5" y="5" width="22" height="22" fill="none" stroke="currentColor" stroke-width="2"/>
                                    <rect x="33" y="5" width="22" height="22" fill="none" stroke="currentColor" stroke-width="2"/>
                                    <rect x="5" y="33" width="22" height="22" fill="none" stroke="currentColor" stroke-width="2"/>
                                    <rect x="33" y="33" width="22" height="22" fill="none" stroke="currentColor" stroke-width="2"/>
                                </svg>
                                <span>Квадратики</span>
                                <small>Простая сетка</small>
                            </div>
                        </label>
                    </div>
                </div>

                <div class="control-section">
                    <h3>Сложность</h3>
                    <div class="difficulty-control">
                        <input type="range" id="difficultySlider" min="1" max="10" value="3" class="difficulty-slider">
                        <div class="difficulty-labels">
                            <span>Легко</span>
                            <span>Сложно</span>
                        </div>
                        <div class="pieces-info">
                            <span class="pieces-count" id="piecesCount">12</span>
                            <span class="pieces-label">частей</span>
                            <span class="pieces-grid" id="piecesGrid">(4 × 3)</span>
                        </div>
                    </div>
                </div>

                <div class="control-section">
                    <h3>Размер бумаги</h3>
                    <div class="paper-selector">
                        <label class="paper-option">
                            <input type="radio" name="paperSize" value="a4" checked>
                            <div class="paper-card">
                                <span class="paper-name">A4</span>
                                <span class="paper-size">297×210 мм</span>
                            </div>
                        </label>
                        <label class="paper-option">
                            <input type="radio" name="paperSize" value="a3">
                            <div class="paper-card">
                                <span class="paper-name">A3</span>
                                <span class="paper-size">420×297 мм</span>
                            </div>
                        </label>
                    </div>
                </div>

                <div class="control-section">
                    <h3>Дополнительно</h3>
                    <div class="control-row checkbox-row">
                        <label class="checkbox-label">
                            <input type="checkbox" id="keepAspectRatio" checked>
                            <span class="checkbox-text">Сохранить пропорции изображения</span>
                        </label>
                    </div>
                    <div class="control-row">
                        <label for="margin">Отступы (мм):</label>
                        <input type="number" id="margin" min="0" max="30" value="10" class="number-input">
                    </div>
                    <div class="control-row">
                        <label for="lineWidth">Толщина линий:</label>
                        <input type="number" id="lineWidth" min="0.5" max="3" step="0.1" value="0.5" class="number-input">
                        <span class="unit">мм</span>
                    </div>
                </div>

                <button id="generateBtn" class="btn-primary">
                    <span class="btn-icon">&#9881;</span>
                    Генерировать пазл
                </button>
            </div>

            <!-- Right Panel - Preview -->
            <div class="preview-panel">
                <div class="preview-header">
                    <h2>Предварительный просмотр</h2>
                    <div class="preview-info" id="previewInfo"></div>
                </div>
                <div class="preview-container" id="previewContainer">
                    <div class="preview-placeholder">
                        <p>Загрузите изображение и нажмите "Генерировать пазл"</p>
                    </div>
                </div>
            </div>
        </div>

        <!-- Export Panel -->
        <div class="export-panel">
            <h2>Экспорт</h2>
            <div class="export-buttons">
                <button id="exportPNG" class="btn-export btn-png" disabled>
                    <span class="export-icon">&#128190;</span>
                    <div class="export-text">
                        <span class="export-title">PNG с изображением</span>
                        <span class="export-desc">Для печати макета</span>
                    </div>
                </button>
                <button id="exportSVG" class="btn-export btn-svg" disabled>
                    <span class="export-icon">&#128196;</span>
                    <div class="export-text">
                        <span class="export-title">SVG (вектор)</span>
                        <span class="export-desc">Для редактирования</span>
                    </div>
                </button>
                <button id="exportDXF" class="btn-export btn-dxf" disabled>
                    <span class="export-icon">&#9881;</span>
                    <div class="export-text">
                        <span class="export-title">DXF для ЧПУ</span>
                        <span class="export-desc">RDWorks, LaserCut</span>
                    </div>
                </button>
                <button id="exportCutLines" class="btn-export btn-cutlines" disabled>
                    <span class="export-icon">&#9986;</span>
                    <div class="export-text">
                        <span class="export-title">PNG контуров</span>
                        <span class="export-desc">Только линии резки</span>
                    </div>
                </button>
            </div>
            <div class="info-panel">
                <p><strong>Инструкция по использованию:</strong></p>
                <ul>
                    <li><strong>PNG с изображением</strong> - распечатайте на бумаге и приклейте к фанере</li>
                    <li><strong>SVG</strong> - редактируйте в Inkscape, CorelDRAW или Illustrator</li>
                    <li><strong>DXF</strong> - загрузите в RDWorks или LaserCut для вырезания на ЧПУ</li>
                    <li><strong>PNG контуров</strong> - только линии для резки без изображения</li>
                </ul>
            </div>
        </div>

        <footer>
            <p>Puzzle Generator - Создавайте пазлы для печати и ЧПУ</p>
        </footer>
    </div>

    <script src="puzzle-generator.js"></script>
    <script src="export-utils.js"></script>
    <script src="app.js"></script>
</body>
</html>
